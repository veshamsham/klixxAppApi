{"version":3,"sources":["server/controllers/trip.js"],"names":["getHistory","req","res","next","historyObjArray","userID","user","_id","userType","searchObj","riderId","driverId","TripSchema","find","$and","tripStatus","sort","bookingTime","tripErr","tripObj","err","APIError","httpStatus","INTERNAL_SERVER_ERROR","length","forEach","obj","index","then","transformedReturnObj","push","returnObj","success","message","data","send","getCloudinaryDetails","Promise","resolve","reject","ServerConfig","findOneAsync","key","foundDetails","value","updateTrip","console","log","cloudinary","config","cloud_name","api_key","api_secret","form","formidable","IncomingForm","on","error","parse","fields","files","img","tripID","tripId","v2","uploader","upload","results","findOneAndUpdateAsync","$set","receiptUrl","url","runValidators","updatedTripObj","meta","BAD_REQUEST","e"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;AAEA;;;;;;;AAQA,SAASA,UAAT,CAAoBC,GAApB,EAAyBC,GAAzB,EAA8BC,IAA9B,EAAoC;AAClC,MAAMC,eAAe,GAAG,EAAxB;AACA,MAAMC,MAAM,GAAGJ,GAAG,CAACK,IAAJ,CAASC,GAAxB,CAFkC,CAEL;;AAC7B,MAAMC,QAAQ,GAAGP,GAAG,CAACK,IAAJ,CAASE,QAA1B;AACA,MAAMC,SAAS,GAAG,EAAlB;;AACA,MAAID,QAAQ,KAAK,OAAjB,EAA0B;AACxBC,IAAAA,SAAS,CAACC,OAAV,GAAoBL,MAApB;AACD,GAFD,MAEO,IAAIG,QAAQ,KAAK,QAAjB,EAA2B;AAChCC,IAAAA,SAAS,CAACE,QAAV,GAAqBN,MAArB;AACD;;AACDO,mBAAWC,IAAX,CACE;AAAEC,IAAAA,IAAI,EAAE,CAACL,SAAD,EAAY;AAAEM,MAAAA,UAAU,EAAE;AAAd,KAAZ;AAAR,GADF,EAEE,IAFF,EAGE;AAAEC,IAAAA,IAAI,EAAE;AAAEC,MAAAA,WAAW,EAAE,CAAC;AAAhB;AAAR,GAHF,EAIE,UAACC,OAAD,EAAUC,OAAV,EAAsB;AACpB;AACA,QAAID,OAAJ,EAAa;AACX,UAAME,GAAG,GAAG,IAAIC,oBAAJ,0DACwCH,OADxC,GAEVI,uBAAWC,qBAFD,CAAZ;AAIA,aAAOpB,IAAI,CAACiB,GAAD,CAAX;AACD;;AACD,QAAID,OAAO,CAACK,MAAR,KAAmB,CAAvB,EAA0B;AACxBL,MAAAA,OAAO,CAACM,OAAR,CAAgB,UAACC,GAAD,EAAMC,KAAN,EAAgB;AAC9B,+CAAeD,GAAf,EAAoBE,IAApB,CAAyB,UAAAC,oBAAoB,EAAI;AAC/CzB,UAAAA,eAAe,CAAC0B,IAAhB,CAAqBD,oBAArB;;AACA,cAAIF,KAAK,KAAKR,OAAO,CAACK,MAAR,GAAiB,CAA/B,EAAkC;AAChC,gBAAMO,SAAS,GAAG;AAChBC,cAAAA,OAAO,EAAE,IADO;AAEhBC,cAAAA,OAAO,EAAE,mBAFO;AAGhBC,cAAAA,IAAI,EAAE9B;AAHU,aAAlB;AAKAF,YAAAA,GAAG,CAACiC,IAAJ,CAASJ,SAAT;AACD;AACF,SAVD;AAWD,OAZD;AAaD,KAdD,MAcO;AACL,UAAMA,SAAS,GAAG;AAChBC,QAAAA,OAAO,EAAE,IADO;AAEhBC,QAAAA,OAAO,EAAE,sBAFO;AAGhBC,QAAAA,IAAI,EAAE;AAHU,OAAlB;AAKAhC,MAAAA,GAAG,CAACiC,IAAJ,CAASJ,SAAT;AACD;AACF,GAnCH;AAqCD;AAED;;;;;;;AAKA,SAASK,oBAAT,GAAgC;AAC9B,SAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtCC,6BAAaC,YAAb,CAA0B;AAAEC,MAAAA,GAAG,EAAE;AAAP,KAA1B,EACGd,IADH,CACQ,UAAAe,YAAY,EAAI;AACpBL,MAAAA,OAAO,CAACK,YAAY,CAACC,KAAd,CAAP;AACD,KAHH,WAIS,UAAAxB,GAAG,EAAI;AACZmB,MAAAA,MAAM,CAACnB,GAAD,CAAN;AACD,KANH;AAOD,GARM,CAAP;AASD;AAED;;;;;;;;;AAQA,SAASyB,UAAT,CAAoB5C,GAApB,EAAyBC,GAAzB,EAA8BC,IAA9B,EAAoC;AAClC2C,EAAAA,OAAO,CAACC,GAAR,CAAY9C,GAAZ,EAAiB,cAAjB,EADkC,CAElC;;AACA,MAAMO,QAAQ,GAAGP,GAAG,CAACK,IAAJ,CAASE,QAA1B;AACA4B,EAAAA,oBAAoB,GACjBR,IADH,CACQ,UAAAgB,KAAK,EAAI;AACb,QAAIA,KAAJ,EAAW;AACTI,6BAAWC,MAAX,CAAkB;AAChBC,QAAAA,UAAU,EAAEN,KAAK,CAACM,UADF;AAEhBC,QAAAA,OAAO,EAAEP,KAAK,CAACO,OAFC;AAGhBC,QAAAA,UAAU,EAAER,KAAK,CAACQ;AAHF,OAAlB;;AAKA,UAAMC,IAAI,GAAG,IAAIC,uBAAWC,YAAf,EAAb;AACAF,MAAAA,IAAI,CAACG,EAAL,CAAQ,OAAR,EAAiB,UAAApC,GAAG,EAAI;AACtB0B,QAAAA,OAAO,CAACW,KAAR,CAAcrC,GAAd,EAAmB,aAAnB,EADsB,CACa;AACpC,OAFD;AAIAiC,MAAAA,IAAI,CAACK,KAAL,CAAWzD,GAAX,EAAgB,UAACmB,GAAD,EAAMuC,MAAN,EAAcC,KAAd,EAAwB;AACtC,YAAMC,GAAG,GAAG,iBAAID,KAAJ,EAAW,YAAX,EAAyB,EAAzB,CAAZ;AACA,YAAME,MAAM,GAAGH,MAAM,CAACI,MAAtB;;AACAf,+BAAWgB,EAAX,CAAcC,QAAd,CAAuBC,MAAvB,CACEL,GADF,EAEE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAACJ,KAAD,EAAQU,OAAR,EAAoB;AAClB,cAAIA,OAAJ,EAAa;AACXvD,6BAAWwD,qBAAX,CACE;AAAE7D,cAAAA,GAAG,EAAEoD,MAAM,CAACI;AAAd,aADF,EAEE;AAAEM,cAAAA,IAAI,EAAE;AAAEC,gBAAAA,UAAU,EAAEH,OAAO,CAACI;AAAtB;AAAR,aAFF,EAGE;AAAE,qBAAK,CAAP;AAAUC,cAAAA,aAAa,EAAE;AAAzB,aAHF,EAKG5C,IALH,CAKQ,UAAA6C,cAAc,EAAI;AACtB;AACA,kBAAM1C,SAAS,GAAG;AAChBC,gBAAAA,OAAO,EAAE,KADO;AAEhBC,gBAAAA,OAAO,EACL,8DAHc;AAIhBC,gBAAAA,IAAI,EAAE,IAJU;AAKhBwC,gBAAAA,IAAI,EAAE;AALU,eAAlB;;AAOA,kBAAID,cAAJ,EAAoB;AAClB1C,gBAAAA,SAAS,CAACC,OAAV,GAAoB,IAApB;AACAD,gBAAAA,SAAS,CAACE,OAAV,GAAoB,qBAApB;AACAF,gBAAAA,SAAS,CAACG,IAAV,GAAiBuC,cAAjB;AACAvE,gBAAAA,GAAG,CAACiC,IAAJ,CAASJ,SAAT;AACD,eALD,MAKO;AACL,oBAAMX,IAAG,GAAG,IAAIC,oBAAJ,CACV,yBADU,EAEVC,uBAAWqD,WAFD,CAAZ;;AAIA,uBAAOxE,IAAI,CAACiB,IAAD,CAAX;AACD;AACF,aA1BH,EA2BGqC,KA3BH,CA2BS,UAAAmB,CAAC,EAAI;AACV,kBAAMxD,GAAG,GAAG,IAAIC,oBAAJ,sDACoCuD,CADpC,GAEVtD,uBAAWC,qBAFD,CAAZ;AAIApB,cAAAA,IAAI,CAACiB,GAAD,CAAJ;AACD,aAjCH;AAkCD;AACF,SAnDH;AAqDD,OAxDD;AAyDD;AACF,GAvEH,WAwES,UAAAwD,CAAC,EAAI;AACV,QAAMxD,GAAG,GAAG,IAAIC,oBAAJ,sDACoCuD,CADpC,GAEVtD,uBAAWC,qBAFD,CAAZ;AAIApB,IAAAA,IAAI,CAACiB,GAAD,CAAJ;AACD,GA9EH;AA+ED;;eAEc;AAAEpB,EAAAA,UAAU,EAAVA,UAAF;AAAc6C,EAAAA,UAAU,EAAVA;AAAd,C","file":"trip.js","sourceRoot":"../../../../.."}